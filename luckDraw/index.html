<!doctype html>
<html>

<head>
	<meta charset="utf-8">
	<title>抽奖</title>

	<link href="css/css.css" rel="stylesheet" type="text/css">
	<link rel="shortcut icon " type="images/x-icon" href="img/cj.png">
	<script type="text/javascript" src="js/jquery.min.js"></script>

</head>

<body>

	<div class="box">
		<p class="Title">中国文旅企业发展峰会暨</br>第二届全国旅游学会年会</p>
		<ul class="prizeList">
			<!-- {%lcmx_gbook_list set="列表名:gbook,显示数目:20,标题长度:20,类别:0,栏目:1"%}
		{%foreach from=$gbook item=list name=foo%}
		<li>{%$smarty.foreach.foo.iteration%}、<span>{%$list.lc_name%}</span><label>{%$list.tel%}</label></li>
		{%/foreach%} -->
		</ul>
		<div class="submit" data-id="0">开 始</div>
	</div>

	<script type="text/javascript">
		let luckDraw = [{
				id: 0,
				name: "游碧竹"
			},
			{
				id: 1,
				name: "肖雅瑜"
			},
			{
				id: 2,
				name: "张慎"
			},
			{
				id: 3,
				name: "张帆"
			},
			{
				id: 4,
				name: "熊健"
			},
			{
				id: 5,
				name: "张辉"
			},
			{
				id: 6,
				name: "刘应捷"
			},
			{
				id: 7,
				name: "向才平"
			},
			{
				id: 8,
				name: "王朝辉"
			},
			{
				id: 9,
				name: "杨宝奕"
			},
			{
				id: 10,
				name: "周志勇"
			},
			{
				id: 11,
				name: "盛芳"
			},
			{
				id: 12,
				name: "龚铁军"
			},
			{
				id: 13,
				name: "夏日光"
			},
			{
				id: 14,
				name: "陈跃辉"
			},
			{
				id: 15,
				name: "何野平"
			},
			{
				id: 16,
				name: "赵小龙"
			},
			{
				id: 17,
				name: "黄俊晶"
			},
			{
				id: 18,
				name: "刘禹"
			},
			{
				id: 19,
				name: "刘元斌"
			},
			{
				id: 20,
				name: "朱志强"
			},
			{
				id: 21,
				name: "常炼"
			},
			{
				id: 22,
				name: "陈卫红"
			},
			{
				id: 23,
				name: "肖自裕"
			},
			{
				id: 24,
				name: "张龙清"
			},
			{
				id: 25,
				name: "朱建良"
			},
			{
				id: 26,
				name: "王志刚"
			},
			{
				id: 27,
				name: "李人杰"
			},
			{
				id: 28,
				name: "窦娟娟"
			},
			{
				id: 29,
				name: "李乐"
			},
			{
				id: 30,
				name: "于可超"
			},
			{
				id: 31,
				name: "曾献南"
			},
			{
				id: 32,
				name: "殷海雄"
			},
			{
				id: 33,
				name: "张可征"
			},
			{
				id: 34,
				name: "贺雪梅"
			},
			{
				id: 35,
				name: "陈加林"
			},
			{
				id: 36,
				name: "苗玉砚"
			},
			{
				id: 37,
				name: "马力"
			},
			{
				id: 38,
				name: "邓爱民"
			},
			{
				id: 39,
				name: "李鹏"
			},
			{
				id: 40,
				name: "耿熠"
			},
			{
				id: 41,
				name: "周年兴"
			},
			{
				id: 42,
				name: "张雪平"
			},
			{
				id: 43,
				name: "项贤峻"
			},
			{
				id: 44,
				name: "刁宗广"
			},
			{
				id: 45,
				name: "韦斌"
			},
			{
				id: 46,
				name: "林伟"
			},
			{
				id: 47,
				name: "李永明"
			},
			{
				id: 48,
				name: "郭道荣"
			},
			{
				id: 49,
				name: "庞铁坚"
			},
			{
				id: 50,
				name: "唐飞鸿"
			},
			{
				id: 51,
				name: "邓小文"
			},
			{
				id: 52,
				name: "陈文杰"
			},
			{
				id: 53,
				name: "谢若雨"
			},
			{
				id: 54,
				name: "叶文智"
			},
			{
				id: 55,
				name: "李锐锋"
			},
			{
				id: 56,
				name: "谢小伟"
			},
			{
				id: 57,
				name: "王方友"
			},
			{
				id: 58,
				name: "汪安坤"
			},
			{
				id: 59,
				name: "王鹏"
			},
			{
				id: 60,
				name: "钱路加"
			},
			{
				id: 61,
				name: "梁军"
			},
			{
				id: 62,
				name: "金鸣"
			},
			{
				id: 63,
				name: "徐华玉"
			},
			{
				id: 64,
				name: "杜东生"
			},
			{
				id: 65,
				name: "丁靖"
			},
			{
				id: 66,
				name: "龚宇"
			},
			{
				id: 67,
				name: "张卫"
			},
			{
				id: 68,
				name: "束晓琳"
			},
			{
				id: 69,
				name: "陈瑶"
			},
			{
				id: 70,
				name: "杨建纲"
			},
			{
				id: 71,
				name: "章发林"
			},
			{
				id: 72,
				name: "戴英群"
			},
			{
				id: 73,
				name: "张贵萍"
			},
			{
				id: 74,
				name: "袁琼庆"
			},
			{
				id: 75,
				name: "周韩辉"
			},
			{
				id: 76,
				name: "罗卫荣"
			},
			{
				id: 77,
				name: "陈建波"
			},
			{
				id: 78,
				name: "龙丁"
			},
			{
				id: 79,
				name: "唐博"
			},
			{
				id: 80,
				name: "陈辉"
			},
			{
				id: 81,
				name: "胡常青"
			},
			{
				id: 82,
				name: "杨成先"
			},
			{
				id: 83,
				name: "陈明桦"
			},
			{
				id: 84,
				name: "张心怡"
			},
			{
				id: 85,
				name: "赵世杰"
			},
			{
				id: 86,
				name: "庄菊香"
			},
			{
				id: 87,
				name: "杨波"
			},
			{
				id: 88,
				name: "黄乐"
			},
			{
				id: 89,
				name: "熊恩国"
			},
			{
				id: 90,
				name: "石毅坚"
			},
			{
				id: 91,
				name: "胡勐"
			},
			{
				id: 92,
				name: "李胜辉"
			},
			{
				id: 93,
				name: "陈平"
			},
			{
				id: 94,
				name: "夏喜衡"
			},
			{
				id: 95,
				name: "付木林"
			},
			{
				id: 96,
				name: "王超"
			},
			{
				id: 97,
				name: "伏六明"
			},
			{
				id: 98,
				name: "阎友兵"
			},
			{
				id: 99,
				name: "黄渊基"
			},
			{
				id: 100,
				name: "陈露"
			},
			{
				id: 101,
				name: "李映辉"
			},
			{
				id: 102,
				name: "徐飞雄"
			},
			{
				id: 103,
				name: "郑宪春"
			},
			{
				id: 104,
				name: "方世敏"
			},
			{
				id: 105,
				name: "刘云国"
			},
			{
				id: 106,
				name: "刘孝利"
			},
			{
				id: 107,
				name: "易伟新"
			},
			{
				id: 108,
				name: "肖友良"
			},
			{
				id: 109,
				name: "娄丽芝"
			},
			{
				id: 110,
				name: "屈中正"
			},
			{
				id: 111,
				name: "易红兵"
			},
			{
				id: 112,
				name: "孟奕爽"
			},
			{
				id: 113,
				name: "黎姣"
			},
			{
				id: 114,
				name: "刘沛林"
			},
			{
				id: 115,
				name: "夏军"
			},
			{
				id: 116,
				name: "黄敏"
			},
			{
				id: 117,
				name: "曾嘉"
			},
			{
				id: 118,
				name: "赵梓颖"
			},
			{
				id: 119,
				name: "贺小荣"
			},
			{
				id: 120,
				name: "李祥明"
			},
			{
				id: 121,
				name: "陈德"
			},
			{
				id: 122,
				name: "廖双寅"
			},
			{
				id: 123,
				name: "薛定刚"
			},
			{
				id: 124,
				name: "刘源"
			},
			{
				id: 125,
				name: "吴丹"
			},
			{
				id: 126,
				name: "罗浩"
			},
			{
				id: 127,
				name: "陈蓝博"
			},
			{
				id: 128,
				name: "彭晓花"
			},
			{
				id: 129,
				name: "谢海初"
			},
			{
				id: 130,
				name: "李惠良"
			},
			{
				id: 131,
				name: "毛世鸿"
			},
			{
				id: 132,
				name: "邹立强"
			},
			{
				id: 133,
				name: "石罡"
			},
			{
				id: 134,
				name: "李晓波"
			},
			{
				id: 135,
				name: "郑义聪"
			},
			{
				id: 136,
				name: "郝鹏"
			},
			{
				id: 137,
				name: "周秋凉"
			},
			{
				id: 138,
				name: "江世平"
			},
			{
				id: 139,
				name: "唐寿根"
			},
			{
				id: 140,
				name: "曾佳凤"
			},
			{
				id: 141,
				name: "易琳媛"
			},
			{
				id: 142,
				name: "涂强"
			},
			{
				id: 143,
				name: "陈夏云"
			},
			{
				id: 144,
				name: "周建冰"
			},
			{
				id: 145,
				name: "郑安居"
			},
			{
				id: 146,
				name: "贾智勇"
			},
			{
				id: 147,
				name: "覃玉虎"
			},
			{
				id: 148,
				name: "刘仕丹"
			},
			{
				id: 149,
				name: "叶伟"
			},
			{
				id: 150,
				name: "熊美"
			},
			{
				id: 151,
				name: "彭泽勇"
			},
			{
				id: 152,
				name: "杜国芬"
			},
			{
				id: 153,
				name: "陈敬萍"
			},
			{
				id: 154,
				name: "王晓燕"
			},
			{
				id: 155,
				name: "彭朝华"
			},
			{
				id: 156,
				name: "张佳"
			},
			{
				id: 157,
				name: "清俊"
			},
			{
				id: 158,
				name: "邹馥莲"
			},
			{
				id: 159,
				name: "邓惺"
			},
			{
				id: 160,
				name: "张朝宇"
			},
			{
				id: 161,
				name: "赖子玲"
			},
			{
				id: 162,
				name: "李晓华"
			},
			{
				id: 163,
				name: "陈文意"
			},
			{
				id: 164,
				name: "罗碧华"
			},
			{
				id: 165,
				name: "郑伟峰"
			},
			{
				id: 166,
				name: "王伟"
			},
			{
				id: 167,
				name: "陈尧"
			},
			{
				id: 168,
				name: "杨柳"
			},
			{
				id: 169,
				name: "王睿"
			},
			{
				id: 170,
				name: "赵明"
			},
			{
				id: 171,
				name: "盈江"
			},
			{
				id: 172,
				name: "尹华浩"
			}
		];
		//从一个给定的数组arr中,随机返回num个不重复项
		function getArrayItems(arr, num) {
			//新建一个数组,将传入的数组复制过来,用于运算,而不要直接操作传入的数组;
			var temp_array = new Array();
			for (var index in arr) {
				temp_array.push(arr[index]);
			}
			//取出的数值项,保存在此数组
			var return_array = new Array();
			for (var i = 0; i < num; i++) {
				//判断如果数组还有可以取出的元素,以防下标越界
				if (temp_array.length > 0) {
					//在数组中产生一个随机索引
					var arrIndex = Math.floor(Math.random() * temp_array.length);
					//将此随机索引的对应的数组元素值复制出来
					return_array[i] = temp_array[arrIndex];
					//然后删掉此索引的数组元素,这时候temp_array变为新的数组
					temp_array.splice(arrIndex, 1);
				} else {
					//数组中数据项取完后,退出循环,比如数组本来只有10项,但要求取出20项.
					break;
				}
			}
			return return_array;
		}
		var interval;
		var MAX = 10;
		$(".submit").click(function () {
			var status = $(this).data("id");
			var ints;
			if (status == 0) {
				// $.get("data.json", {}, function (data) {
				// 	if (data) {
				// 		if (data.code == "1") {
				// 			function times() {
				// 				var ArrList = data.data;
				// 				var res = getArrayItems(ArrList, 10);
				// 				str = '';
				// 				for (o in res) {
				// 					num = parseInt(o) + 1;
				// 					str += '<li data-id="' + res[o].id + '">' + num + '、<span>' + res[o]
				// 						.name + '</span></li>';
				// 					// <label>'+res[o].tel+'</label>
				// 				}
				// 				$(".prizeList").html(str);
				// 			}
				// 			interval = setInterval(times, 0);
				// 			$(".submit").data("id", "1");
				// 			$(".submit").text("停止");
				// 		}
				// 	} else {
				// 		alert('Ajax error!');
				// 	}
				// }, 'json');
				var now = gen.next().value;
				$(".Title").text(now.tit + "中奖名单显示");
				MAX = now.num;
				interval = setInterval(times, 0);
				$(".submit").data("id", "1");
				$(".submit").text("停止");
			} else {
				clearInterval(interval);
				delLuckyer()
				$(".submit").data("id", "0");
				$(".submit").text("开始");
			}
		})

		function times() {
			var res = getArrayItems(luckDraw, MAX);
			str = '';
			for (o in res) {
				num = parseInt(o) + 1;
				str += '<li data-id="' + res[o].id + '">' + num + '、<span>' + res[o]
					.name + '</span></li>';
			}
			$(".prizeList").html(str);
		}
		// 这是已中奖的幸运儿将他们移除后续抽奖
		var sum = 1;

		function delLuckyer(arr) {
			console.log(`==========这是第${sum}轮中奖的幸运儿===========`);
			sum++;
			$("li").each(function () {
				console.log($(this).text())
				// console.log($(this).data("id") + '-' + $(this).text())
				delArray($(this).data("id"));
			});
		}
		// 我就喜欢分开写^_^
		function delArray(id) {
			const array = luckDraw.filter(i => i.id == id);
			const Pointer = luckDraw.indexOf(array[0]);
			luckDraw.splice(Pointer, 1);
			// console.log(luckDraw);
		}
		let gen = generator();
		// 抽奖步骤使用迭代器
		function* generator() {
			// 幸运奖 5*10 位
			yield {
				tit: '第一轮幸运奖',
				num: 10
			};
			yield {
				tit: '第二轮幸运奖',
				num: 10
			};
			yield {
				tit: '第三轮幸运奖',
				num: 10
			};
			yield {
				tit: '第四轮幸运奖',
				num: 10
			};
			yield {
				tit: '第五轮幸运奖',
				num: 10
			};
			// 三等奖 10位
			yield {
				tit: '三等奖',
				num: 10
			};
			// 二等奖 5位
			yield {
				tit: '二等奖',
				num: 5
			};
			// 一等奖 2位
			yield {
				tit: '一等奖',
				num: 2
			};
		}
	</script>
</body>

</html>